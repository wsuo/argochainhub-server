# æ™ºæ…§å†œåŒ–é‡‡è´­å¹³å° - æŠ€æœ¯æ¶æ„ä¸APIæ¥å£æ€»è§ˆ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±‚ (å¾…å¼€å‘)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     APIç½‘å…³ / è´Ÿè½½å‡è¡¡                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     NestJS åº”ç”¨æœåŠ¡å±‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   åå°ç®¡ç†æ¨¡å—   â”‚  â”‚   ä¸šåŠ¡æµç¨‹æ¨¡å—   â”‚  â”‚   ç”¨æˆ·æƒé™æ¨¡å—   â”‚  â”‚
â”‚  â”‚   (29ä¸ªæ¥å£)    â”‚  â”‚   (18ä¸ªæ¥å£)    â”‚  â”‚   (8ä¸ªæ¥å£)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   è®¤è¯æˆæƒ      â”‚  â”‚   æ•°æ®éªŒè¯      â”‚  â”‚   å¼‚å¸¸å¤„ç†      â”‚  â”‚
â”‚  â”‚   Guards       â”‚  â”‚   DTOs/Pipes    â”‚  â”‚   Filters      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       æ•°æ®æŒä¹…å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   MySQL æ•°æ®åº“   â”‚  â”‚   Redis ç¼“å­˜    â”‚  â”‚   TypeORM ORM   â”‚  â”‚
â”‚  â”‚   (13ä¸ªå®ä½“)    â”‚  â”‚   (ä¼šè¯å­˜å‚¨)    â”‚  â”‚   (å¯¹è±¡æ˜ å°„)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       å¤–éƒ¨æœåŠ¡å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç«å±±å¼•æ“ç¿»è¯‘API  â”‚  â”‚ ç«å±±å¼•æ“TOSå­˜å‚¨  â”‚  â”‚   ç¬¬ä¸‰æ–¹æ”¯ä»˜     â”‚  â”‚
â”‚  â”‚   (å·²é›†æˆ)      â”‚  â”‚   (å·²é…ç½®)      â”‚  â”‚   (å¾…é›†æˆ)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ•°æ®æ¨¡å‹æ¶æ„

### æ ¸å¿ƒå®ä½“å…³ç³»å›¾

```
ç”¨æˆ·å®ä½“ (User)
â”œâ”€â”€ ä¼ä¸šå®ä½“ (Company) [1:N]
â”‚   â”œâ”€â”€ äº§å“å®ä½“ (Product) [1:N]
â”‚   â”œâ”€â”€ è®¢é˜…å®ä½“ (Subscription) [1:N]
â”‚   â””â”€â”€ è®¢å•å®ä½“ (Order) [1:N]
â”œâ”€â”€ è¯¢ä»·å•å®ä½“ (Inquiry) [1:N]
â”œâ”€â”€ æ ·å“ç”³è¯·å®ä½“ (SampleRequest) [1:N]
â””â”€â”€ ç™»è®°ç”³è¯·å®ä½“ (RegistrationRequest) [1:N]

ç®¡ç†å‘˜å®ä½“ (AdminUser)
â”œâ”€â”€ è§’è‰²å®ä½“ (Role) [N:M] - å¾…å®ç°
â”œâ”€â”€ æƒé™å®ä½“ (Permission) [N:M] - å¾…å®ç°
â””â”€â”€ å®¡è®¡æ—¥å¿—å®ä½“ (AuditLog) [1:N]

è®¡åˆ’å®ä½“ (Plan)
â”œâ”€â”€ è®¢é˜…å®ä½“ (Subscription) [1:N]
â””â”€â”€ è®¢å•å®ä½“ (Order) [1:N]
```

### æ•°æ®å®ä½“è¯¦æƒ…

| å®ä½“åç§° | è¡¨å | ä¸»è¦å­—æ®µ | å…³è”å…³ç³» |
|---------|------|---------|---------|
| User | users | id, username, email, name | Company(1:N) |
| Company | companies | id, name(å¤šè¯­è¨€), type, status | User(N:1), Product(1:N) |
| Product | products | id, name(å¤šè¯­è¨€), category(å¤šè¯­è¨€), supplier | Company(N:1) |
| Inquiry | inquiries | id, inquiryNo, status, buyer, supplier | User(N:1), Company(N:1) |
| SampleRequest | sample_requests | id, sampleReqNo, status, trackingInfo | User(N:1), Product(N:1) |
| RegistrationRequest | registration_requests | id, regReqNo, status, targetCountry | User(N:1), Product(N:1) |
| AdminUser | admin_users | id, username, role, isActive | AuditLog(1:N) |
| Subscription | subscriptions | id, type, status, startDate, endDate | Company(N:1), Plan(N:1) |
| Order | orders | id, orderNo, amount, status | Company(N:1), User(N:1) |
| Plan | plans | id, name, price, durationDays, isActive | Subscription(1:N) |
| AuditLog | audit_logs | id, action, details, ipAddress | AdminUser(N:1) |

## ğŸ”— APIæ¥å£æ€»è§ˆ

### æ¥å£åˆ†ç±»ç»Ÿè®¡

| æ¨¡å—åˆ†ç±» | æ¥å£æ•°é‡ | å®ŒæˆçŠ¶æ€ | å¤‡æ³¨ |
|---------|---------|---------|------|
| åå°ç®¡ç†-åŸºç¡€åŠŸèƒ½ | 2 | âœ… å®Œæˆ | ä»ªè¡¨ç›˜ã€ç»Ÿè®¡ |
| åå°ç®¡ç†-ä¼ä¸šç®¡ç† | 7 | âœ… å®Œæˆ | å«CRUDæ¥å£ |
| åå°ç®¡ç†-äº§å“ç®¡ç† | 7 | âœ… å®Œæˆ | å«CRUDæ¥å£ |
| åå°ç®¡ç†-ç”¨æˆ·ç®¡ç† | 2 | âœ… å®Œæˆ | æŸ¥è¯¢åŠŸèƒ½ |
| åå°ç®¡ç†-è®¢é˜…ç®¡ç† | 3 | âœ… å®Œæˆ | è®¢é˜…æ“ä½œ |
| åå°ç®¡ç†-è®¢å•ç®¡ç† | 2 | âœ… å®Œæˆ | æŸ¥è¯¢åŠŸèƒ½ |
| åå°ç®¡ç†-ä¼šå‘˜è®¡åˆ’ | 4 | âœ… å®Œæˆ | è®¡åˆ’CRUD |
| åå°ç®¡ç†-å·¥å…·æœåŠ¡ | 2 | âœ… å®Œæˆ | ç¿»è¯‘æœåŠ¡ |
| ä¸šåŠ¡æµç¨‹-è¯¢ä»·å• | 6 | âœ… å®Œæˆ | å®Œæ•´æµç¨‹ |
| ä¸šåŠ¡æµç¨‹-æ ·å“ç”³è¯· | 6 | âœ… å®Œæˆ | å®Œæ•´æµç¨‹ |
| ä¸šåŠ¡æµç¨‹-ç™»è®°ç”³è¯· | 6 | âœ… å®Œæˆ | å®Œæ•´æµç¨‹ |
| ç®¡ç†å‘˜è´¦æˆ·ç®¡ç† | 8 | âœ… å®Œæˆ | ç”¨æˆ·CRUD |
| è§’è‰²æƒé™ç®¡ç† | 0 | âŒ å¾…å¼€å‘ | é¢„è®¡4-6ä¸ªæ¥å£ |
| å®¡è®¡æ—¥å¿—ç®¡ç† | 0 | âŒ å¾…å¼€å‘ | é¢„è®¡3-4ä¸ªæ¥å£ |
| **æ€»è®¡** | **55** | **94% å®Œæˆ** | **2ä¸ªæ¨¡å—å¾…å¼€å‘** |

### è¯¦ç»†æ¥å£åˆ—è¡¨

#### 1. åå°ç®¡ç†ç³»ç»Ÿ API (29ä¸ªæ¥å£)

**åŸºç¡€åŠŸèƒ½æ¨¡å—**
```http
GET    /admin/dashboard/charts        è·å–ä»ªè¡¨ç›˜å›¾è¡¨æ•°æ®
GET    /admin/stats                   è·å–ç®¡ç†ç»Ÿè®¡æ•°æ®
```

**ä¼ä¸šç®¡ç†æ¨¡å—**
```http
GET    /admin/companies/pending       è·å–å¾…å®¡æ ¸ä¼ä¸šåˆ—è¡¨
POST   /admin/companies/:id/review    å®¡æ ¸ä¼ä¸š
GET    /admin/companies               è·å–æ‰€æœ‰ä¼ä¸šåˆ—è¡¨
GET    /admin/companies/:id           è·å–ä¼ä¸šè¯¦æƒ…
PATCH  /admin/companies/:id/toggle-status  åˆ‡æ¢ä¼ä¸šçŠ¶æ€
POST   /admin/companies               åˆ›å»ºæ–°ä¼ä¸š â­
PUT    /admin/companies/:id           æ›´æ–°ä¼ä¸šä¿¡æ¯ â­
```

**äº§å“ç®¡ç†æ¨¡å—**
```http
GET    /admin/products/pending        è·å–å¾…å®¡æ ¸äº§å“åˆ—è¡¨
POST   /admin/products/:id/review     å®¡æ ¸äº§å“
GET    /admin/products                è·å–æ‰€æœ‰äº§å“åˆ—è¡¨
GET    /admin/products/:id            è·å–äº§å“è¯¦æƒ…
PATCH  /admin/products/:id/toggle-status   åˆ‡æ¢äº§å“çŠ¶æ€
POST   /admin/products                åˆ›å»ºæ–°äº§å“ â­
PUT    /admin/products/:id            æ›´æ–°äº§å“ä¿¡æ¯ â­
```

**ç”¨æˆ·ç®¡ç†æ¨¡å—**
```http
GET    /admin/users                   è·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨
GET    /admin/users/:id               è·å–ç”¨æˆ·è¯¦æƒ…
```

**è®¢é˜…ç®¡ç†æ¨¡å—**
```http
GET    /admin/companies/:id/subscriptions  æŸ¥çœ‹ä¼ä¸šè®¢é˜…å†å²
POST   /admin/companies/:id/subscriptions  æ‰‹åŠ¨ä¸ºä¼ä¸šæ·»åŠ è®¢é˜…
DELETE /admin/subscriptions/:id            å–æ¶ˆ/ç»ˆæ­¢è®¢é˜…
```

**è®¢å•ç®¡ç†æ¨¡å—**
```http
GET    /admin/orders                  è·å–æ‰€æœ‰è®¢å•åˆ—è¡¨
GET    /admin/orders/:id              æŸ¥çœ‹è®¢å•è¯¦æƒ…
```

**ä¼šå‘˜è®¡åˆ’ç®¡ç†**
```http
GET    /admin/plans                   è·å–æ‰€æœ‰ä¼šå‘˜è®¡åˆ’
POST   /admin/plans                   åˆ›å»ºæ–°ä¼šå‘˜è®¡åˆ’
PUT    /admin/plans/:id               æ›´æ–°ä¼šå‘˜è®¡åˆ’
PATCH  /admin/plans/:id/status        ä¸Šæ¶æˆ–ä¸‹æ¶ä¼šå‘˜è®¡åˆ’
```

**å·¥å…·æœåŠ¡**
```http
POST   /admin/utilities/translate     ç¿»è¯‘æ–‡æœ¬
POST   /admin/utilities/detect-language  æ£€æµ‹æ–‡æœ¬è¯­è¨€
```

#### 2. ä¸šåŠ¡æµç¨‹ç®¡ç† API (18ä¸ªæ¥å£)

**è¯¢ä»·å•ä¸šåŠ¡æµç¨‹**
```http
GET    /admin/inquiries               è·å–è¯¢ä»·å•åˆ—è¡¨
GET    /admin/inquiries/stats         è·å–è¯¢ä»·å•ç»Ÿè®¡æ•°æ®
GET    /admin/inquiries/:id           è·å–è¯¢ä»·å•è¯¦æƒ…
PATCH  /admin/inquiries/:id/status    æ›´æ–°è¯¢ä»·å•çŠ¶æ€
DELETE /admin/inquiries/:id           åˆ é™¤è¯¢ä»·å•
```

**æ ·å“ç”³è¯·ä¸šåŠ¡æµç¨‹**
```http
GET    /admin/sample-requests         è·å–æ ·å“ç”³è¯·åˆ—è¡¨
GET    /admin/sample-requests/stats   è·å–æ ·å“ç”³è¯·ç»Ÿè®¡æ•°æ®
GET    /admin/sample-requests/:id     è·å–æ ·å“ç”³è¯·è¯¦æƒ…
PATCH  /admin/sample-requests/:id/status  æ›´æ–°æ ·å“ç”³è¯·çŠ¶æ€
DELETE /admin/sample-requests/:id     åˆ é™¤æ ·å“ç”³è¯·
```

**ç™»è®°ç”³è¯·ä¸šåŠ¡æµç¨‹**
```http
GET    /admin/registration-requests   è·å–ç™»è®°ç”³è¯·åˆ—è¡¨
GET    /admin/registration-requests/stats  è·å–ç™»è®°ç”³è¯·ç»Ÿè®¡æ•°æ®
GET    /admin/registration-requests/:id    è·å–ç™»è®°ç”³è¯·è¯¦æƒ…
PATCH  /admin/registration-requests/:id/status  æ›´æ–°ç™»è®°ç”³è¯·çŠ¶æ€
DELETE /admin/registration-requests/:id    åˆ é™¤ç™»è®°ç”³è¯·
```

#### 3. ç®¡ç†å‘˜è´¦æˆ·ç®¡ç† API (8ä¸ªæ¥å£)

```http
GET    /admin/admin-users             è·å–ç®¡ç†å‘˜ç”¨æˆ·åˆ—è¡¨
GET    /admin/admin-users/stats       è·å–ç®¡ç†å‘˜ç”¨æˆ·ç»Ÿè®¡æ•°æ®
GET    /admin/admin-users/:id         è·å–ç®¡ç†å‘˜ç”¨æˆ·è¯¦æƒ…
POST   /admin/admin-users             åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
PUT    /admin/admin-users/:id         æ›´æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯
PATCH  /admin/admin-users/:id/password       ä¿®æ”¹ç®¡ç†å‘˜ç”¨æˆ·å¯†ç 
PATCH  /admin/admin-users/:id/reset-password é‡ç½®ç®¡ç†å‘˜ç”¨æˆ·å¯†ç 
PATCH  /admin/admin-users/:id/toggle-status  åˆ‡æ¢ç®¡ç†å‘˜ç”¨æˆ·çŠ¶æ€
DELETE /admin/admin-users/:id         åˆ é™¤ç®¡ç†å‘˜ç”¨æˆ·
```

#### 4. å¾…å¼€å‘ API

**è§’è‰²æƒé™ç®¡ç†** (é¢„è®¡4-6ä¸ªæ¥å£)
```http
GET    /admin/roles                   è·å–æ‰€æœ‰è§’è‰²åˆ—è¡¨
POST   /admin/roles                   åˆ›å»ºæ–°è§’è‰²
PUT    /admin/roles/:id               æ›´æ–°è§’è‰²ä¿¡æ¯
DELETE /admin/roles/:id               åˆ é™¤è§’è‰²
POST   /admin/roles/:id/permissions   ä¸ºè§’è‰²åˆ†é…æƒé™
GET    /admin/permissions             è·å–æ‰€æœ‰æƒé™åˆ—è¡¨
```

**å®¡è®¡æ—¥å¿—ç®¡ç†** (é¢„è®¡3-4ä¸ªæ¥å£)
```http
GET    /admin/audit-logs              è·å–å®¡è®¡æ—¥å¿—åˆ—è¡¨
GET    /admin/audit-logs/stats        è·å–å®¡è®¡æ—¥å¿—ç»Ÿè®¡
GET    /admin/audit-logs/:id          è·å–å®¡è®¡æ—¥å¿—è¯¦æƒ…
GET    /admin/audit-logs/export       å¯¼å‡ºå®¡è®¡æ—¥å¿—
```

## ğŸ›¡ï¸ å®‰å…¨æ¶æ„

### è®¤è¯æˆæƒæœºåˆ¶

```typescript
// è®¤è¯æµç¨‹
1. ç”¨æˆ·ç™»å½• â†’ JWT Tokenç”Ÿæˆ
2. è¯·æ±‚æºå¸¦ Authorization: Bearer <token>
3. AuthGuardéªŒè¯Tokenæœ‰æ•ˆæ€§
4. RolesGuardéªŒè¯ç”¨æˆ·æƒé™
5. æ‰§è¡Œä¸šåŠ¡é€»è¾‘

// æƒé™æ§åˆ¶è£…é¥°å™¨
@AdminRoles('admin', 'super_admin')  // è§’è‰²çº§æƒé™
@Permissions('company:create')       // åŠŸèƒ½çº§æƒé™ (å¾…å®ç°)
```

### Guardå®ˆå«ç³»ç»Ÿ

| å®ˆå«åç§° | ä½œç”¨ | åº”ç”¨èŒƒå›´ |
|---------|------|---------|
| AdminAuthGuard | éªŒè¯ç®¡ç†å‘˜èº«ä»½ | æ‰€æœ‰adminæ¥å£ |
| AdminRolesGuard | éªŒè¯ç®¡ç†å‘˜è§’è‰² | éœ€è¦ç‰¹å®šè§’è‰²çš„æ¥å£ |
| PermissionGuard | éªŒè¯ç»†ç²’åº¦æƒé™ | å¾…å®ç° |

### æ•°æ®éªŒè¯æœºåˆ¶

```typescript
// DTOéªŒè¯ç®¡é“
1. è¯·æ±‚æ•°æ® â†’ ValidationPipe
2. class-validatorè£…é¥°å™¨éªŒè¯
3. class-transformeræ•°æ®è½¬æ¢
4. éªŒè¯å¤±è´¥ â†’ 400 Bad Request
5. éªŒè¯é€šè¿‡ â†’ è¿›å…¥Controller

// éªŒè¯è£…é¥°å™¨ç¤ºä¾‹
@IsString()
@MinLength(3)
@MaxLength(50)
username: string;
```

## ğŸ”§ æŠ€æœ¯æ ˆè¯¦æƒ…

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|---------|------|------|
| NestJS | 9.x | Node.jsåº”ç”¨æ¡†æ¶ |
| TypeScript | 4.x | ç±»å‹å®‰å…¨çš„JavaScript |
| TypeORM | 0.3.x | å¯¹è±¡å…³ç³»æ˜ å°„ |
| MySQL | 8.0+ | å…³ç³»å‹æ•°æ®åº“ |
| Redis | 6.x+ | ç¼“å­˜å’Œä¼šè¯å­˜å‚¨ |
| class-validator | 0.14.x | æ•°æ®éªŒè¯ |
| class-transformer | 0.5.x | æ•°æ®è½¬æ¢ |
| bcrypt | 5.x | å¯†ç åŠ å¯† |
| jsonwebtoken | 9.x | JWTä»¤ç‰Œå¤„ç† |
| @nestjs/swagger | 6.x | APIæ–‡æ¡£ç”Ÿæˆ |

### å¤–éƒ¨æœåŠ¡é›†æˆ

| æœåŠ¡åç§° | æä¾›å•† | é›†æˆçŠ¶æ€ | ç”¨é€” |
|---------|--------|---------|------|
| ç¿»è¯‘API | ç«å±±å¼•æ“ | âœ… å·²é›†æˆ | å¤šè¯­è¨€ç¿»è¯‘ |
| å¯¹è±¡å­˜å‚¨TOS | ç«å±±å¼•æ“ | âœ… å·²é…ç½® | æ–‡ä»¶å­˜å‚¨ |
| æ”¯ä»˜ç½‘å…³ | å¾…é€‰æ‹© | âŒ å¾…é›†æˆ | åœ¨çº¿æ”¯ä»˜ |
| çŸ­ä¿¡æœåŠ¡ | å¾…é€‰æ‹© | âŒ å¾…é›†æˆ | éªŒè¯ç å‘é€ |
| é‚®ä»¶æœåŠ¡ | å¾…é€‰æ‹© | âŒ å¾…é›†æˆ | é‚®ä»¶é€šçŸ¥ |

## ğŸ“ˆ æ€§èƒ½ä¸ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

```sql
-- ä¸»è¦ç´¢å¼•ç­–ç•¥
CREATE INDEX idx_company_status ON companies(status);
CREATE INDEX idx_product_status_category ON products(status, category);
CREATE INDEX idx_inquiry_status_created ON inquiries(status, created_at);
CREATE INDEX idx_user_email ON users(email);
CREATE INDEX idx_admin_username ON admin_users(username);

-- åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
-- ä½¿ç”¨LIMIT + OFFSETå®ç°åˆ†é¡µ
-- æ”¯æŒORDER BYæ€§èƒ½ä¼˜åŒ–
```

### æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥

| ä¼˜åŒ–ç±»å‹ | å®ç°æ–¹å¼ | æ•ˆæœ |
|---------|---------|------|
| å…³è”æŸ¥è¯¢ | leftJoinAndSelect | å‡å°‘N+1æŸ¥è¯¢ |
| åˆ†é¡µæŸ¥è¯¢ | LIMIT + OFFSET | æ§åˆ¶è¿”å›æ•°æ®é‡ |
| æ¡ä»¶ç­›é€‰ | WHEREå­å¥ä¼˜åŒ– | å‡å°‘æ•°æ®æ‰«æ |
| å­—æ®µé€‰æ‹© | selectæŒ‡å®šå­—æ®µ | å‡å°‘æ•°æ®ä¼ è¾“ |

### ç¼“å­˜ç­–ç•¥

```typescript
// Redisç¼“å­˜åº”ç”¨åœºæ™¯ (å¾…å®ç°)
1. ç”¨æˆ·ä¼šè¯ç¼“å­˜ - 30åˆ†é’ŸTTL
2. æƒé™æ•°æ®ç¼“å­˜ - 1å°æ—¶TTL
3. ç»Ÿè®¡æ•°æ®ç¼“å­˜ - 5åˆ†é’ŸTTL
4. é…ç½®æ•°æ®ç¼“å­˜ - 24å°æ—¶TTL
```

## ğŸš€ éƒ¨ç½²æ¶æ„

### ç¯å¢ƒé…ç½®

```bash
# å¼€å‘ç¯å¢ƒ
NODE_ENV=development
APP_PORT=3010
DB_HOST=localhost
DB_PORT=3306
REDIS_HOST=localhost
REDIS_PORT=6379

# ç”Ÿäº§ç¯å¢ƒ
NODE_ENV=production
APP_PORT=3010
DB_HOST=mysql-prod-server
DB_PORT=3306
REDIS_HOST=redis-prod-server
REDIS_PORT=6379
```

### Dockerå®¹å™¨åŒ–

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS runtime
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
EXPOSE 3010
CMD ["npm", "run", "start:prod"]
```

### ç›‘æ§ä¸æ—¥å¿—

| ç›‘æ§ç±»å‹ | å·¥å…·é€‰æ‹© | å®ç°çŠ¶æ€ |
|---------|---------|---------|
| åº”ç”¨ç›‘æ§ | å¾…é€‰æ‹© | âŒ å¾…å®ç° |
| é”™è¯¯è¿½è¸ª | NestJS Logger | âœ… å·²å®ç° |
| æ€§èƒ½ç›‘æ§ | å¾…é€‰æ‹© | âŒ å¾…å®ç° |
| æ—¥å¿—æ”¶é›† | å¾…é€‰æ‹© | âŒ å¾…å®ç° |

## ğŸ“‹ APIæ–‡æ¡£

### Swaggeræ–‡æ¡£é…ç½®

```typescript
// è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
è®¿é—®åœ°å€: http://localhost:3010/api
æ–‡æ¡£ç‰¹æ€§:
- è‡ªåŠ¨æ ¹æ®DTOç”Ÿæˆè¯·æ±‚/å“åº”æ¨¡å‹
- æ”¯æŒåœ¨çº¿æµ‹è¯•æ¥å£
- åŒ…å«è¯¦ç»†çš„å‚æ•°è¯´æ˜
- é”™è¯¯ç å’ŒçŠ¶æ€ç è¯´æ˜
```

### è¯·æ±‚å“åº”æ ¼å¼

```typescript
// ç»Ÿä¸€å“åº”æ ¼å¼
{
  "data": any,           // ä¸šåŠ¡æ•°æ®
  "meta"?: {             // åˆ†é¡µä¿¡æ¯(å¯é€‰)
    "totalItems": number,
    "itemCount": number,
    "itemsPerPage": number,
    "totalPages": number,
    "currentPage": number
  },
  "message"?: string     // æç¤ºä¿¡æ¯(å¯é€‰)
}

// é”™è¯¯å“åº”æ ¼å¼
{
  "statusCode": number,
  "message": string | string[],
  "error": string
}
```

## ğŸ¯ æŠ€æœ¯å€ºåŠ¡ä¸æ”¹è¿›å»ºè®®

### å½“å‰æŠ€æœ¯å€ºåŠ¡

1. **å•å…ƒæµ‹è¯•è¦†ç›–ç‡ä½** - éœ€è¦è¡¥å……æ§åˆ¶å™¨å’ŒæœåŠ¡å±‚æµ‹è¯•
2. **APIé™æµç¼ºå¤±** - éœ€è¦æ·»åŠ æ¥å£è°ƒç”¨é¢‘ç‡é™åˆ¶
3. **ç¼“å­˜æœºåˆ¶å¾…å®Œå–„** - Redisç¼“å­˜ç­–ç•¥éœ€è¦å®ç°
4. **ç›‘æ§ä½“ç³»ç¼ºå¤±** - éœ€è¦é›†æˆAPMå’Œæ—¥å¿—æ”¶é›†

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–** - è°ƒæ•´è¿æ¥æ± å¤§å°å’Œè¶…æ—¶è®¾ç½®
2. **æŸ¥è¯¢è¯­å¥ä¼˜åŒ–** - ä½¿ç”¨ç´¢å¼•å’Œé¿å…N+1æŸ¥è¯¢
3. **åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–** - å¤§æ•°æ®é‡æ—¶ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µ
4. **å›¾ç‰‡èµ„æºä¼˜åŒ–** - é›†æˆCDNå’Œå›¾ç‰‡å‹ç¼©æœåŠ¡

### å®‰å…¨åŠ å›ºå»ºè®®

1. **è¾“å…¥éªŒè¯åŠ å¼º** - æ·»åŠ XSSå’ŒSQLæ³¨å…¥é˜²æŠ¤
2. **è®¿é—®æ—¥å¿—è®°å½•** - è®°å½•æ‰€æœ‰æ•æ„Ÿæ“ä½œ
3. **APIç‰ˆæœ¬æ§åˆ¶** - æ”¯æŒå‘åå…¼å®¹çš„ç‰ˆæœ¬ç®¡ç†
4. **HTTPSå¼ºåˆ¶** - ç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ä½¿ç”¨HTTPS

è¿™ä¸ªæŠ€æœ¯æ¶æ„æ–‡æ¡£ä¸ºç³»ç»Ÿçš„è¿›ä¸€æ­¥å¼€å‘å’Œç»´æŠ¤æä¾›äº†å…¨é¢çš„å‚è€ƒåŸºç¡€ã€‚