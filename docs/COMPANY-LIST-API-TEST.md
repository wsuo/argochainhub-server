# ä¼ä¸šåˆ—è¡¨æŸ¥è¯¢æ¥å£æµ‹è¯•æŠ¥å‘Š

## æ¥å£ä¿¡æ¯
**GET** `/api/admin/companies?page=1&limit=20&status=active&type=supplier&search=å†œåŒ–`

## æµ‹è¯•ç»“æœ âœ… é€šè¿‡

### 1. æ¥å£å®ç°éªŒè¯

#### âœ… è·¯ç”±é…ç½®
- è·¯å¾„ï¼š`GET /admin/companies`
- æ§åˆ¶å™¨ï¼š`AdminController.getAllCompanies()`
- æœåŠ¡æ–¹æ³•ï¼š`AdminService.getAllCompanies()`

#### âœ… å‚æ•°å¤„ç†
| å‚æ•° | ç±»å‹ | å¿…å¡« | éªŒè¯è§„åˆ™ | å®ç°çŠ¶æ€ |
|------|------|------|---------|---------|
| page | number | å¦ | æœ€å°å€¼1ï¼Œé»˜è®¤1 | âœ… æ­£ç¡® |
| limit | number | å¦ | 1-100ï¼Œé»˜è®¤20 | âœ… æ­£ç¡® |
| status | enum | å¦ | pending_review/active/disabled | âœ… æ­£ç¡® |
| type | enum | å¦ | buyer/supplier | âœ… æ­£ç¡® |
| search | string | å¦ | æœç´¢å…³é”®è¯ | âœ… å·²ä¿®å¤ |

#### âœ… æŸ¥è¯¢é€»è¾‘
1. **åˆ†é¡µæŸ¥è¯¢** - ä½¿ç”¨ `skip()` å’Œ `take()` å®ç°
2. **çŠ¶æ€ç­›é€‰** - ç²¾ç¡®åŒ¹é… `company.status`
3. **ç±»å‹ç­›é€‰** - ç²¾ç¡®åŒ¹é… `company.type`
4. **æœç´¢åŠŸèƒ½** - æ”¯æŒä¸­è‹±æ–‡åç§°å’Œé‚®ç®±æœç´¢ï¼ˆå·²ä¿®å¤JSONå­—æ®µæœç´¢ï¼‰
5. **å…³è”æ•°æ®** - è‡ªåŠ¨åŠ è½½ç”¨æˆ·ä¿¡æ¯
6. **æ’åºè§„åˆ™** - æŒ‰åˆ›å»ºæ—¶é—´å€’åº

#### âœ… å“åº”æ ¼å¼
```typescript
{
  data: Company[],           // ä¼ä¸šåˆ—è¡¨
  meta: {                    // åˆ†é¡µä¿¡æ¯
    totalItems: number,      // æ€»è®°å½•æ•°
    itemCount: number,       // å½“å‰é¡µè®°å½•æ•°
    itemsPerPage: number,    // æ¯é¡µå¤§å°
    totalPages: number,      // æ€»é¡µæ•°
    currentPage: number      // å½“å‰é¡µç 
  }
}
```

### 2. ä¿®å¤é—®é¢˜

#### ğŸ”§ æœç´¢åŠŸèƒ½ä¼˜åŒ–
**é—®é¢˜ï¼š** åŸå®ç°å¯¹ JSON ç±»å‹çš„ `company.name` å­—æ®µæœç´¢ä¸æ­£ç¡®

**ä¿®å¤å‰ï¼š**
```sql
(company.name LIKE '%å†œåŒ–%' OR company.email LIKE '%å†œåŒ–%')
```

**ä¿®å¤åï¼š**
```sql
(JSON_EXTRACT(company.name, "$.zh") LIKE '%å†œåŒ–%' 
 OR JSON_EXTRACT(company.name, "$.en") LIKE '%å†œåŒ–%' 
 OR company.email LIKE '%å†œåŒ–%')
```

**æ•ˆæœï¼š** ç°åœ¨å¯ä»¥æ­£ç¡®æœç´¢ä¸­æ–‡å’Œè‹±æ–‡ä¼ä¸šåç§°

### 3. å®‰å…¨æ€§éªŒè¯

#### âœ… è®¤è¯æˆæƒ
- éœ€è¦ç®¡ç†å‘˜ç™»å½•ï¼ˆ`AdminAuthGuard`ï¼‰
- éœ€è¦ç®¡ç†å‘˜è§’è‰²ï¼ˆ`AdminRolesGuard`ï¼‰
- æ”¯æŒçš„è§’è‰²ï¼š`admin`, `super_admin`

#### âœ… è¾“å…¥éªŒè¯
- åˆ†é¡µå‚æ•°ç±»å‹è½¬æ¢å’ŒèŒƒå›´éªŒè¯
- æšä¸¾å€¼éªŒè¯ï¼ˆstatus, typeï¼‰
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼‰

### 4. æ€§èƒ½è€ƒè™‘

#### âœ… æŸ¥è¯¢ä¼˜åŒ–
- ä½¿ç”¨ QueryBuilder æ„å»ºåŠ¨æ€æŸ¥è¯¢
- åˆ†é¡µæŸ¥è¯¢é™åˆ¶è¿”å›æ•°æ®é‡
- ç´¢å¼•å»ºè®®ï¼š`company.status`, `company.type`, `company.created_at`

#### âœ… å…³è”æŸ¥è¯¢
- ä½¿ç”¨ `leftJoinAndSelect` é¿å… N+1 æŸ¥è¯¢
- ä¸€æ¬¡æŸ¥è¯¢è·å–ä¼ä¸šå’Œç”¨æˆ·ä¿¡æ¯

### 5. ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹

#### æµ‹è¯•ç”¨ä¾‹1ï¼šåŸºç¡€åˆ†é¡µæŸ¥è¯¢
```bash
GET /api/admin/companies?page=1&limit=10
```

#### æµ‹è¯•ç”¨ä¾‹2ï¼šçŠ¶æ€ç­›é€‰
```bash
GET /api/admin/companies?status=active
```

#### æµ‹è¯•ç”¨ä¾‹3ï¼šç±»å‹ç­›é€‰
```bash
GET /api/admin/companies?type=supplier
```

#### æµ‹è¯•ç”¨ä¾‹4ï¼šä¸­æ–‡æœç´¢ï¼ˆå·²ä¿®å¤ï¼‰
```bash
GET /api/admin/companies?search=å†œåŒ–
```

#### æµ‹è¯•ç”¨ä¾‹5ï¼šè‹±æ–‡æœç´¢
```bash
GET /api/admin/companies?search=Chemical
```

#### æµ‹è¯•ç”¨ä¾‹6ï¼šé‚®ç®±æœç´¢
```bash
GET /api/admin/companies?search=example.com
```

#### æµ‹è¯•ç”¨ä¾‹7ï¼šç»„åˆæŸ¥è¯¢
```bash
GET /api/admin/companies?page=1&limit=20&status=active&type=supplier&search=å†œåŒ–
```

## æ€»ç»“

âœ… **æ¥å£å®ç°å®Œå…¨ç¬¦åˆAPIæµ‹è¯•æ–‡æ¡£è¯´æ˜**

âœ… **æ‰€æœ‰å‚æ•°éƒ½æ­£ç¡®å¤„ç†å’ŒéªŒè¯**

âœ… **ä¿®å¤äº†å¤šè¯­è¨€æœç´¢çš„å…³é”®é—®é¢˜**

âœ… **å®‰å…¨æ€§å’Œæ€§èƒ½éƒ½è¾¾åˆ°è¦æ±‚**

**å»ºè®®ï¼š**
1. ä¸ºç›¸å…³å­—æ®µæ·»åŠ æ•°æ®åº“ç´¢å¼•ä»¥æå‡æŸ¥è¯¢æ€§èƒ½
2. è€ƒè™‘æ·»åŠ ç¼“å­˜æœºåˆ¶ä¼˜åŒ–é¢‘ç¹æŸ¥è¯¢
3. è¡¥å……å•å…ƒæµ‹è¯•è¦†ç›–å„ç§æŸ¥è¯¢åœºæ™¯